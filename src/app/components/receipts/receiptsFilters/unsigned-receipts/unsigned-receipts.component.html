<app-receipts-bar [companyId]="companyId"></app-receipts-bar>
<br>
<div class="container" *ngIf="company">
    <div [hidden]="this.userService.getUser().UserType !== 3">
        <h2 class="text-center">Recibos de nómina no firmados de {{company.CompanyName}}</h2>
        <br>
    </div>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 text-center">
                <mat-form-field style="width: 100%;">
                    <mat-icon matPrefix>search</mat-icon>
                    <input matInput #search placeholder="Buscar Recibo" (keyup)="0" />
                </mat-form-field>
                <br>
            </div>
            <div class="col-md-3 text-center">
                <button mat-raised-button color="primary" *ngIf="updateBtn" (click)="sendNotifications();"
                        style="margin: 5px;"
                        i18n="action | button which will send a notification to the employees to sign the selected receipt.">
                    Notificar Empleados
                </button>
            </div>
        </div>
        <div class="row">
            <small class="font-light text-right" style="color: #2cbbc3; float: right;">Resultados: {{documents ? (documents | listfilter: search.value)?.length : '0'}}</small>
            <div class="table-responsive vertical-scroll-temp">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th scope="col" class="pointer" (click)="sortedBy('DocumentId')">
                            <div style="white-space: nowrap">
                                ID
                                <i class="material-icons" *ngIf="sortKey === 'DocumentId' && !sortAsc">arrow_drop_down</i>
                                <i class="material-icons" *ngIf="sortKey === 'DocumentId' && sortAsc">arrow_drop_up</i>
                            </div>
                        </th>
                        <th scope="col" class="pointer" (click)="sortedBy('PayperiodDate')">
                            <div style="white-space: nowrap">
                                Período de Pago
                                <i class="material-icons" *ngIf="sortKey === 'PayperiodDate' && !sortAsc">arrow_drop_down</i>
                                <i class="material-icons" *ngIf="sortKey === 'PayperiodDate' && sortAsc">arrow_drop_up</i>
                            </div>
                        </th>
                        <th scope="col" class="pointer" (click)="sortedBy('EmployeeName')">
                            <div style="white-space: nowrap">
                                Nombre de Empleado
                                <i class="material-icons" *ngIf="sortKey === 'EmployeeName' && !sortAsc">arrow_drop_down</i>
                                <i class="material-icons" *ngIf="sortKey === 'EmployeeName' && sortAsc">arrow_drop_up</i>
                            </div>
                        </th>
                        <th scope="col" class="pointer" (click)="sortedBy('EmployeeRfc')">
                            <div style="white-space: nowrap">
                                RFC de Empleado
                                <i class="material-icons" *ngIf="sortKey === 'EmployeeRfc' && !sortAsc">arrow_drop_down</i>
                                <i class="material-icons" *ngIf="sortKey === 'EmployeeRfc' && sortAsc">arrow_drop_up</i>
                            </div>
                        </th>
                        <th scope="col" class="pointer" (click)="sortedBy('UUID')">
                            <div style="white-space: nowrap">
                                UUID
                                <i class="material-icons" *ngIf="sortKey === 'UUID' && !sortAsc">arrow_drop_down</i>
                                <i class="material-icons" *ngIf="sortKey === 'UUID' && sortAsc">arrow_drop_up</i>
                            </div>
                        </th>
                        <th scope="col" class="pointer" (click)="sortedBy('UploadTime')">
                            <div style="white-space: nowrap">
                                Fecha Carga
                                <i class="material-icons" *ngIf="sortKey === 'UploadTime' && !sortAsc">arrow_drop_down</i>
                                <i class="material-icons" *ngIf="sortKey === 'UploadTime' && sortAsc">arrow_drop_up</i>
                            </div>
                        </th>
                        <th scope="col" class="centerText" (click)="selectAllDocuments();">
                            <button type="button" class="btn btn-secondary" data-toggle="tooltip" data-placement="top" title="Tooltip on top">
                                Seleccionar Todos
                            </button>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let e of documents | listfilter: search.value | sortBy:sortKey:sortAsc" class="pointer">
                        <th [routerLink]="['/document-viewer', companyId, e.DocumentId]" scope="row">{{e.DocumentId}}</th>
                        <td [routerLink]="['/document-viewer', companyId, e.DocumentId]">{{e.PayperiodDate | date:'shortDate':'':'mx'}}</td>
                        <td [routerLink]="['/document-viewer', companyId, e.DocumentId]">{{e.EmployeeName}}</td>
                        <td [routerLink]="['/document-viewer', companyId, e.DocumentId]">{{e.EmployeeRfc}}</td>
                        <td [routerLink]="['/document-viewer', companyId, e.DocumentId]" style="white-space: nowrap">{{e.UUID}}</td>
                        <td [routerLink]="['/document-viewer', companyId, e.DocumentId]">{{e.UploadTime | date:'shortDate':'':'mx'}}</td>
                        <td class="centerText">
                            <mat-checkbox class="example-margin" [(ngModel)]="e.CheckedBox" color="primary"
                                          (change)="selectedCheckBox();"></mat-checkbox>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row justify-content-md-center" *ngIf="!isPromiseDone">
            <mat-spinner></mat-spinner>
        </div>
        <div class="row justify-content-md-center" *ngIf="isPromiseDone && documents.length < 1">
            <h1>No se encontraron recibos de nómina.</h1>
        </div>
    </div>
    <br><br><br><br>
</div>
